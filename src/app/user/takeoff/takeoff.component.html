<div style='padding-left:15px;padding-right:15px;overflow:auto;width:100%;height: 90%;' (scroll)="onWindowScroll()"
    #scrollMe>
    <ng-container *ngIf='loading'>
        <div nz-row>

            &nbsp;
        </div>

        <div nz-row>
            <div nz-col nzSpan="24" style='text-align: center'>
                <nz-spin nzTip="Please wait....Loading Images" nzSimple [nzSize]="'large'"></nz-spin>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf='!loading'>


        <ng-container *ngIf='coupons.length == 0'>
            <nz-empty nzNotFoundContent='No Coupons Found'></nz-empty>
        </ng-container>

        <ng-container *ngIf='coupons.length > 0'>

            <div class='row'>

                <div class="col-lg-{{columns}}" *ngFor="let item of coupons">


                    <div nz-row class="coupon" style=' width:305px;height:430px;'>
                        <div nz-col nzSpan='24'>
                            <div class="container" nz-col nzSpan="24" style=' border-radius: 15px 15px 0 0 ; text-align: left;  padding: 2px 16px;
                    background-color: #f1f1f1;'>

                                <h6> {{item.vendorName}}</h6>

                            </div>
                            <div style='overflow:auto;'>

                                <div class="container"
                                    style='border-radius: 0px ;width:300px;height:300px;overflow:hidden;padding:0px'
                                    (click)='coupon=item;previewVisible=true;'>
                                    <img style=' width:300px;height:300px ;' id="image" [src]="item.image">
                                    <img [class]="item.image_align" [src]="item.logo"
                                        style='max-height: 80px;border: 1px solid  #bbb;'>




                                    <div
                                        style='padding: 5px;position: absolute;bottom: 0; background: rgb(0, 0, 0);background: rgba(0, 0, 0, 0.5); color: #f1f1f1; width: 300px; height: 100px'>


                                        <h5 [style.text-decoration]='item.header_decoration'
                                            [style.font-weight]='item.header_bold'
                                            [style.font-style]='item.header_style' style='word-wrap: break-word;color: #f1f1f1;'>
                                            {{item.header}}</h5>

                                        <p [style.text-decoration]='item.body_decoration'
                                            [style.font-weight]='item.body_bold' [style.font-style]='item.body_style' style='word-wrap: break-word;'>
                                             {{item.body}}</p>

                                        <p [style.text-decoration]='item.footer_decoration'
                                            [style.font-weight]='item.footer_bold'
                                            [style.font-style]='item.footer_style' style='word-wrap: break-word;'>
                                             {{item.footer}}</p>



                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="container" nz-col nzSpan="24" style='text-align: center; border-radius: 0 0  15px 15px; padding:0;
                background-color: #f1f1f1;'>
                            <div nz-col nzSpan="24">

                                <i nz-icon nzType="line" nzTheme="outline"></i>
                                <i nz-icon nzType="line" nzTheme="outline"></i>&nbsp;
                                <i nz-icon nzType="scissor" nzTheme="outline"></i>&nbsp;

                                <i nz-icon nzType="line" nzTheme="outline"></i>
                                <i nz-icon nzType="line" nzTheme="outline"></i>&nbsp;
                                <i nz-icon nzType="scissor" nzTheme="outline"></i>&nbsp;

                                <i nz-icon nzType="line" nzTheme="outline"></i>
                                <i nz-icon nzType="line" nzTheme="outline"></i>&nbsp;
                                <i nz-icon nzType="scissor" nzTheme="outline"></i>&nbsp;

                                <i nz-icon nzType="line" nzTheme="outline"></i>
                                <i nz-icon nzType="line" nzTheme="outline"></i>&nbsp;
                                <i nz-icon nzType="scissor" nzTheme="outline"></i>&nbsp;

                                <i nz-icon nzType="line" nzTheme="outline"></i>
                                <i nz-icon nzType="line" nzTheme="outline"></i>
                            </div>
                            <div nz-col nzSpan="24">
                                <h6 style="font-size:15px;color:red">Expires on
                                    {{item.expireTime}}</h6>
                            </div>
                            <div nz-col nzSpan="24">
                                <div nz-row>

                                    <div nz-col nzSpan="2">&nbsp;</div>

                                    <div nz-col nzSpan="4" data-toggle="tooltip" data-placement="top"
                                        title="Redem Coupon">

                                        <i nz-icon nzType="gift" nzTheme="fill" style="font-size: 20px; color: blue"
                                            class='icon' (click)='viewRedemption(item)'></i><br />
                                        {{item.redemptionCount}}

                                    </div>

                                    <div nz-col nzSpan="4" data-toggle="tooltip" data-placement="top"
                                        title="Visit Vendor Store">

                                        <i nz-icon nzType="bank" nzTheme="fill" style="font-size: 20px; color: brown "
                                            class='icon'></i>

                                    </div>

                                    <div nz-col nzSpan="4" data-toggle="tooltip" data-placement="top"
                                        title="Like Coupon">

                                        <i nz-icon [nzType]="item.likeLoading?'smile':'like'"
                                            [nzTheme]="item.likeCoupon?'fill':'outline'"
                                            style="font-size: 20px; color:green" class='icon'
                                            (click)="like(item)"></i><br />

                                        {{item.likeCount}}

                                    </div>

                                    <div nz-col nzSpan="4" data-toggle="tooltip" data-placement="top"
                                        title="DisLike Coupon">

                                        <i nz-icon [nzType]="item.likeLoading?'frown':'dislike'"
                                            [nzTheme]="item.disLikeCoupon?'fill':'outline'"
                                            style="font-size: 20px; color:red" class='icon'
                                            (click)="dislike(item)"></i><br />
                                        {{item.dislikeCount}}

                                    </div>

                                    <div nz-col nzSpan="4" data-toggle="tooltip" data-placement="top"
                                        title="Download Coupon">

                                        <i nz-icon nzType="download" nzTheme="outline" style="font-size: 20px;"
                                            class='icon'></i>

                                    </div>

                                    <div nz-col nzSpan="2">&nbsp;</div>

                                </div>


                            </div>

                        </div>


                    </div>

                    <hr />

                </div>
            </div>
        </ng-container>

    </ng-container>

    <ng-container *ngIf='bottom && !noMoreImages'>
        <div nz-row>

            &nbsp;
        </div>

        <div nz-row>
            <div nz-col nzSpan="24" style='text-align: center'>
                <nz-spin nzTip="Please wait....Loading Images" nzSimple [nzSize]="'large'"></nz-spin>
            </div>
        </div>
    </ng-container>


    <nz-modal [nzVisible]="previewVisible" [nzContent]="modalContent" [nzFooter]="null" (nzOnCancel)="cancel()">
        <ng-template #modalContent>



            <div style='overflow:auto;'>
                <div class="container" style='width:300px;height:300px;overflow:hidden;'>
                    <img style=' width:300px;height:300px;' id="image" [src]="coupon.image">
                    <img [class]="coupon.image_align" [src]="coupon.logo"
                        style='max-height: 80px;border: 1px solid  #bbb;'>


                    <!-- <div [class]="coupon.footer_align" [style.font-family]='coupon.footer_font'
                        [style.color]='coupon.footer_color' [style.text-decoration]='coupon.footer_decoration'
                        [style.font-weight]='coupon.footer_bold' [style.font-style]='coupon.footer_style'
                        [style.font-size.px]="coupon.footer_size" [innerHTML]="coupon.footer | replaceNewLine "></div>







                    <div [class]="coupon.header_align" [style.font-family]='coupon.header_font'
                        [style.color]='coupon.header_color' [style.text-decoration]='coupon.header_decoration'
                        [style.font-weight]='coupon.header_bold' [style.font-style]='coupon.header_style'
                        [style.font-size.px]="coupon.header_size" [innerHTML]="coupon.header  | replaceNewLine ">



                    </div>



                    <div [class]="coupon.body_align" [style.font-family]='coupon.body_font'
                        [style.color]='coupon.body_color' [style.text-decoration]='coupon.body_decoration'
                        [style.font-weight]='coupon.body_bold' [style.font-style]="coupon.body_style"
                        [style.font-size.px]="coupon.body_size" [innerHTML]="coupon.body  | replaceNewLine  ">
                    </div> -->

                    <div
                    style='padding: 5px;position: absolute;bottom: 0; background: rgb(0, 0, 0);background: rgba(0, 0, 0, 0.5); color: #f1f1f1; width: 300px; height: 100px'>



                        <h5 [style.text-decoration]='coupon.header_decoration' [style.font-weight]='coupon.header_bold'
                        style='word-wrap: break-word;' [style.font-style]='coupon.header_style' style='color: #f1f1f1;'> {{coupon.header}}</h5>

                        <p [style.text-decoration]='coupon.body_decoration' [style.font-weight]='coupon.body_bold'
                        style='word-wrap: break-word;' [style.font-style]='coupon.body_style'>{{coupon.body}}</p>

                        <p [style.text-decoration]='coupon.footer_decoration' [style.font-weight]='coupon.footer_bold'
                        style='word-wrap: break-word;' [style.font-style]='coupon.footer_style'>{{coupon.footer}}</p>


                    </div>



                </div>


            </div>



        </ng-template>
    </nz-modal>

</div>



<nz-modal [nzVisible]="redeemVisible" [nzContent]="redeemContent" [nzFooter]="null" (nzOnCancel)="redeemCancel()">
    <ng-template #redeemContent>
        <h3>
            <ng-container *ngIf='redeemChecked'>
                <span nz-icon nzType="arrow-left" nzTheme="outline" (click)='redeemChecked=false'> </span>
            </ng-container> Redemption
            <ng-container *ngIf='redeemLoading'>
                <nz-spin nzTip="Loading..." nzSimple [nzSize]="'small'" style='text-align: center'></nz-spin>
            </ng-container>
        </h3>
        <div nz-row class="container">
            <ng-container *ngIf='!redeemChecked'>
                <div nz-col nzSpan="24" style='text-align: left'>
                    <nz-collapse nzAccordion>
                        <nz-collapse-panel nzHeader="Coupon Description" nzActive="true" nzDisabled="false">
                            <p> content</p>
                        </nz-collapse-panel>
                        <nz-collapse-panel nzHeader="TakeOff Terms & Conditions" nzDisabled="false">
                            <p> TakeOff Terms & Conditions</p>
                        </nz-collapse-panel>
                    </nz-collapse>
                </div>
                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>
                <div nz-col nzSpan="24" style='text-align: center'>
                    <label nz-checkbox [(ngModel)]="redeemChecked"
                        (ngModelChange)='generateRedemption(redeemCoupon.id,redeemCoupon.vendorId)'>I have read Coupon
                        Description and Terms &
                        Conditions</label>
                </div>
            </ng-container>
            <ng-container *ngIf='redeemChecked'>




                <div nz-col nzSpan="24" style='text-align: center'>
                    <nz-table nzSize="small" nzShowPagination=false [nzData]="['']">
                        <thead>
                            <tr>
                                <th style='text-align:center'>Coupon ID</th>
                                <th style='text-align:center'>User ID</th>
                                <th style='text-align:center'>Vendor ID</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr style='text-align:center'>
                                <td>{{redeemCoupon.id}}</td>
                                <td>{{loginStatus.userId}}</td>
                                <td>{{redeemCoupon.vendorId}}</td>
                            </tr>
                        </tbody>
                    </nz-table>
                </div>
                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>

                <div nz-col nzSpan="24" style='text-align: center'><b><i><u>Passcode To Vendor</u></i></b></div>

                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>
                <div nz-col nzSpan="24" style='text-align: center'>
                    <input readonly nz-input style='width: 40px;' type="text" maxlength="1"
                        [(ngModel)]="code[0]" />&nbsp;&nbsp;
                    <input readonly nz-input style='width: 40px;' type="text" maxlength="1"
                        [(ngModel)]="code[1]" />&nbsp;&nbsp;
                    <input readonly nz-input style='width: 40px;' type="text" maxlength="1"
                        [(ngModel)]="code[2]" />&nbsp;&nbsp;
                    <input readonly nz-input style='width: 40px;' type="text" maxlength="1"
                        [(ngModel)]="code[3]" />&nbsp;&nbsp;
                </div>
                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>

                <div nz-col nzSpan="24" style='text-align: center'>
                    For WhatsApp Redemption Format for Vendor is
                    <b><i>{{redeemCoupon.id}},{{loginStatus.userId}},{{code[0]+code[1]+code[2]+code[3]}}</i></b>
                </div>

                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>



                <div nz-col nzSpan="24" style='text-align: center'><b><i><u>Passcode From Vendor</u></i></b></div>

                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>

                <div nz-col nzSpan="24" style='text-align: center'>
                    <input nz-input style='width: 40px;' type="text" maxlength="1" [(ngModel)]="code[4]" />&nbsp;&nbsp;
                    <input nz-input style='width: 40px;' type="text" maxlength="1" [(ngModel)]="code[5]" />&nbsp;&nbsp;
                    <input nz-input style='width: 40px;' type="text" maxlength="1" [(ngModel)]="code[6]" />&nbsp;&nbsp;
                    <input nz-input style='width: 40px;' type="text" maxlength="1" [(ngModel)]="code[7]" />&nbsp;&nbsp;
                </div>
                <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>

                <div nz-col nzSpan="24" style='text-align: center'>

                    Passcode Valid till <b><i><u>{{redemption.validTill}}</u></i></b>

                </div>
                <ng-container *ngIf='!redeemLoading'>
                    <div nz-col nzSpan="24" style='text-align: center'>&nbsp;</div>
                    <div nz-col nzSpan="24" style='text-align: center'>
                        <button nz-button nzType="default">HELP</button> &nbsp;
                        <button nz-button nzType="primary" nzShape="round" nzDanger
                            (click)='customerRedeem()'>REDEEM</button> &nbsp;
                        <button nz-button nzType="primary" nzShape="round" (click)="redeemCancel()">CANCEL</button>
                    </div>
                </ng-container>
            </ng-container>
        </div>
    </ng-template>
</nz-modal>